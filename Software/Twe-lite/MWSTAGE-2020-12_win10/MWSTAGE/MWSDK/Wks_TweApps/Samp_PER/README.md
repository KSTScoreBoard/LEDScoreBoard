# パケットエラー測定ツール (v2.06-1)

　　　　　　　　　　　　　　　　　　　　　　　モノワイヤレス株式会社 2015/10/21

1. はじめに
　本ツールは、無線ノード間のパケットエラー率を測定する測定を目的とします。パケットエラー率 (PER: Packet Error Rate) は、測定端から他の測定端へパケットを送信するとき、どれくらいの割合で送信が成功するかで定義されます。

2. 利用条件
　本ツールはモノワイヤレス株式会社の著作物です。提供されるバイナリ、ソースコード、資料は TWE (The WIRELESS ENGINE) シリーズにのみ利用できます。
　本ツールは無保証です。不具合等が発見された場合はモノワイヤレス株式会社サポート宛に報告をお願い致します。ただし報告された不具合等の修正を約束するものではありません。

3. ファームウェアの書き込み

  ・親機側（UART での操作が可能な状態）にはPER_Master_JN51xx_yy.bin (xx はチップモデル
  　yy はバージョン番号) を書き込みます。

  ・子機側には PER_Slave_JN51xx_yy.bin (xx はチップモデル yy はバージョン番号) を書き込みます。

4. 操作方法

  (0) 親機・子機を条件の良いごく近くに配置する。

  (1) 親機のシリアルポート(UART0) を  115200bps 8N1 で開いておく。

  (2) 子機の電源を入れる。

  (3) 親機をリセットまたは電源投入する。

  (4) 子機のアドレスが見つかったら '1' を入力し選択する。（ここで子機がリストされない場合は、最初からやりなしてください）

  (5) 親子間がごく近くにある条件で 's' キーを押して動作確認を行う。（よほど悪い環境でない限り、90%以上のパケット送信が成功します）

  (6) 必要に応じて、測定条件（カウント数など）を変更します。測定条件変更後には 's' キーを押して動作確認を行ってください。（測定条件を子機に反映するための通信が発生します。無線送受信環境が悪いと子機に反映されません）

  (7) 親機子機を計測したい場所に移動します。

  (8) 's' を押して測定を開始します。（測定条件は無線送受信環境が良い場合は変更できますが、一般には(6)で設定した後は、変更しないほうが良いでしょう）

  

5. 操作コマンド

| キー       |                    |                                                              |
| ---------- | ------------------ | ------------------------------------------------------------ |
| 'n', 'N'   | RESCAN NODES       | ノードを再スキャンする                                       |
| '0', '1-4' | SHOW, CHOOSE NODES | ノードリストの表示、選択を行う                               |
| 'a', 'A'   | SET APPACK         | AppAck モードの ON/OFF を設定します。AppAck=OFF では IEEE802.15.4 の MAC ACK の受信をもって成功とします。AppAck=ON は[親機]->[子機]へ送信後 [子機]->[親機] へ返しのパケット送信が成功した場合に「成功」とします。 |
| 'c', 'C'   | SET TX COUNT       | 試行回数の設定                                               |
| 'p', 'P'   | SET PAYLOAD SIZE   | 無線パケットのペイロード（データ部）のサイズを設定           |
| '>', '<'   | CH UP, DOWN        | 無線チャネルの切り替え (11-26)                               |
| 'r', 'R'   | SET RETRY COUNT    | 再送回数の設定                                               |
| 't', 'T'   | SET TIMER ms       | 送信周期 [ms] を設定                                         |
| 'o', 'O'   | SET Power          | 送信出力の設定                                               |
| 's', SPACE | START PER TEST     | テストの開始                                                 |
| 'b', 'B'   | STOP PER TEST      | テストの中断                                                 |



6. 制限事項など

   ・モノワイヤレス株式会社は、測定結果の正確性を保証するものではありません。

   ・複数の同ツールが同一電波範囲内に存在した場合は、パケットが混信する場合があります。同一チャネル内でSlave側を複数ノード動作させた場合です。

   ・AppAckモードで動作させた場合、稀に MacAck より AppAck のエラー率が低く表示される場合があります。Master側は MacAck は受信できなかったが、子機側はパケットを正しく受信でき返送パケット送信に成功した場合などが考えられます。

   ・AppAckモードでは、送信間隔(Tick)を短く設定し MacAck 再送回数が多く設定されると、返信が時間内に間に合わずパケット送受信が混雑しエラー率が上昇します。Tick は、20ms 以上を推奨します。

   ・ビットエラー率は測定できません。

   ・親機側では現在販売していない液晶デバイスの制御コードが含まれています。そのため、UART0 ポート以外のポートが制御される場合があります。